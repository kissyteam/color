modulex.add("color",[],function(t,n,r){var a;a=function(t){function n(t,n){for(var r in n)t[r]=n[r]}function r(t,n){for(var r=0,a=t.length;a>r&&n(t[r])!==!1;r++);}function a(t){n(this,t)}function e(t){return 255*t}function i(t){var n,r,a,i=Math.min(Math.round(t.h),359),s=Math.max(0,Math.min(1,t.s)),u=Math.max(0,Math.min(1,t.v)),o=Math.floor(i/60%6),h=i/60-o,c=u*(1-s),f=u*(1-h*s),M=u*(1-(1-h)*s);switch(o){case 0:n=u,r=M,a=c;break;case 1:n=f,r=u,a=c;break;case 2:n=c,r=u,a=M;break;case 3:n=c,r=f,a=u;break;case 4:n=M,r=c,a=u;break;case 5:n=u,r=c,a=f}return{r:g(e(n)),g:g(e(r)),b:g(e(a))}}function s(t){var n,r,a,e=t.r/255,i=t.g/255,s=t.b/255,u=Math.min(Math.min(e,i),s),o=Math.max(Math.max(e,i),s),h=o-u;switch(o){case u:n=0;break;case e:n=60*(i-s)/h,s>i&&(n+=360);break;case i:n=60*(s-e)/h+120;break;case s:n=60*(e-i)/h+240}return r=0===o?0:1-u/o,a={h:Math.round(n),s:r,v:o}}function u(t){var n,a,i,s=Math.min(Math.round(t.h),359),u=Math.max(0,Math.min(1,t.s)),o=Math.max(0,Math.min(1,t.l)),h=[],c=Math.abs,f=Math.floor;if(0===u||null==s)h=[o,o,o];else{switch(s/=60,n=u*(1-c(2*o-1)),a=n*(1-c(s-2*f(s/2)-1)),i=o-n/2,f(s)){case 0:h=[n,a,0];break;case 1:h=[a,n,0];break;case 2:h=[0,n,a];break;case 3:h=[0,a,n];break;case 4:h=[a,0,n];break;case 5:h=[n,0,a]}h=[h[0]+i,h[1]+i,h[2]+i]}return r(h,function(t,n){h[n]=e(t)}),{r:h[0],g:h[1],b:h[2]}}function o(t){return parseInt(t,16)}function h(t){return t+16*t}function c(t){return 2!==t.length&&(t="0"+t),t}function f(t){return Math.round(100*t)+"%"}function g(t){return Math.max(0,Math.min(t,255))}var M=/\s*rgba?\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*(?:,\s*([\d\.]+))?\)\s*/,b=/\s*#([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)\s*/;return t=a,a.prototype={constructor:a,getR:function(){return Math.round(this.r)},getG:function(){return Math.round(this.g)},getB:function(){return Math.round(this.b)},getA:function(){return this.a},toHSL:function(){var t=this.getHSL();return"hsl("+Math.round(t.h||0)+", "+f(t.s)+", "+f(t.l)+")"},toHSLA:function(){var t=this.getHSL();return"hsla("+Math.round(t.h||0)+", "+f(t.s)+", "+f(t.l)+", "+this.getA()+")"},toRGB:function(){var t=this;return"rgb("+t.getR()+", "+t.getG()+", "+t.getB()+")"},toRGBA:function(){var t=this;return"rgba("+t.getR()+", "+t.getG()+", "+t.getB()+", "+t.getA()+")"},toHex:function(){var t=this;return"#"+c(Number(t.getR()).toString(16))+c(Number(t.getG()).toString(16))+c(Number(t.getB()).toString(16))},toString:function(){return this.toRGBA()},getHSL:function(){var t,n=this,r=n.getR()/255,a=n.getG()/255,e=n.getB()/255,i=Math.max(r,a,e),s=Math.min(r,a,e),u=i-s,o=0,h=.5*(i+s);return s!==i&&(o=.5>h?u/(i+s):u/(2-i-s),t=r===i?60*(a-e)/u:a===i?120+60*(e-r)/u:240+60*(r-a)/u,t=(t+360)%360),{h:t,s:o,l:h}},getHSV:function(){return s({r:this.getR(),g:this.getG(),b:this.getB()})},setHSV:function(t){var n,a=this;"h"in t&&"s"in t&&"v"in t||(n=a.getHSV(),r(["h","s","v"],function(r){r in t&&(n[r]=t[r])}),t=n),a.set(i(t))},setHSL:function(t){var n,a=this;"h"in t&&"s"in t&&"l"in t||(n=a.getHSL(),r(["h","s","l"],function(r){r in t&&(n[r]=t[r])}),t=n),a.set(u(t))}},n(a,{parse:function(t){var n,r,e,i,s=1;return 4!==t.length&&7!==t.length||"#"!==t.substr(0,1)?(n=t.match(M),n&&(r=parseInt(n[1],10),e=parseInt(n[2],10),i=parseInt(n[3],10),s=parseFloat(n[4])||1)):(n=t.match(b),n&&(r=o(n[1]),e=o(n[2]),i=o(n[3]),4===t.length&&(r=h(r),e=h(e),i=h(i)))),"undefined"==typeof r?void 0:new a({r:r,g:e,b:i,a:s})},fromHSL:function(t){var n=u(t);return n.a=t.a,new a(n)},fromHSV:function(t){var n=i(t);return n.a=t.a,new a(n)}}),t}(),r.exports=a});